Spring IOC要解决的问题

2024年2月20日

15:19

 

1.  问题一： dao层或service层接口，使用的时候都需要new 实现类对象，使用实现类对象调用，service层的实现类implh中耦合了dao层impl，若切换dao层实现类，serve层实现类impl要跟着改变，耦合不符合面向接口开发最优原则。

2.  解决：

    1.  工厂模式：将使用工厂模式生产对象，工厂模式解耦合

        1.  从xml读取配置文件中类的全限定类名

        2.  使用反射创建对象class.forname

        3.  提供获取对象的方式

3.  实现步骤：

    1.  定义map

    2.  解析xml，反射创建对象（实例化bean）

    3.  将对象存入map

    4.  实例化完成后维护对象之间的依赖关系，检查哪些对象需要传值进入，传入指（xml中property属性）

    5.  找到需要被处理依赖关系的bean

    6.  调用父类对象反射功能，通过set方法传值进去

    7.  将新bean存入map

4.  问题二：service层没有事务控制，事务控制dao层

    1.  原因：两次update创建的是连个数据库连接

    2.  解决：两次update在一个线程threadlocal中调用，使用同一个数据库连接，和当前线程有关的数据库操作都使用这一个connetction
