# 网络路由设置

Windows 主机的路由表的工具，用于告诉操作系统应该如何将网络流量发送到目标 IP 地址或网段。以下是命令的详细解释：

------

### 基本命令格式

```
cmd


复制代码
route add <目标地址> mask <子网掩码> <网关地址>
```

#### 参数说明：

1. **`route`**
   Windows 自带的路由管理命令工具，支持添加、删除和查看路由。
2. **`add`**
   添加一条新的路由规则。
3. **`<目标地址>`**
   指定目标 IP 地址或网络。比如：
   - 单个 IP：`172.168.40.8`
   - 一个网段：`172.168.40.0`（通常配合子网掩码）
4. **`mask`**
   子网掩码，确定目标是一个单一的 IP 地址还是一个网段。例如：
   - `255.255.255.255`：匹配单个 IP 地址。
   - `255.255.255.0`：匹配一个网段（比如 `172.168.40.0` 中所有 IP 地址）。
5. **`<网关地址>`**
   下一跳地址，数据包要发往的中间设备（如路由器或交换机）的 IP。此设备应能连通目标地址所在的网段。
6. **`-p`**
   可选参数，表示永久添加。没有 `-p` 参数时，路由规则在系统重启后失效。

------

### 常用示例

#### 1. 添加单个 IP 的路由（临时）

```
cmd


复制代码
route add 172.168.40.8 mask 255.255.255.255 172.16.31.1
```

解释：

- **目标**：`172.168.40.8`（单一 IP）
- **子网掩码**：`255.255.255.255`（只匹配 `172.168.40.8`）
- **网关**：`172.16.31.1`，流量会发送到这个网关。

------

#### 2. 添加一个网段的路由（永久）

```
cmd


复制代码
route -p add 172.168.40.0 mask 255.255.255.0 172.16.31.1
```

解释：

- **目标**：`172.168.40.0`（整个网段）
- **子网掩码**：`255.255.255.0`（网段范围为 `172.168.40.0 ~ 172.168.40.255`）
- **网关**：`172.16.31.1`
- **`-p`**：永久生效，即使重启也不会丢失。

------

#### 3. 查看当前路由表

```
cmd


复制代码
route print
```

解释：

- 列出当前主机的所有路由规则，包括：
  - **网络目标**：目标 IP 或网段。
  - **子网掩码**：用于划分目标范围。
  - **网关**：将流量发送到的下一跳地址。
  - **接口**：通过哪个网络接口（如网卡）发送数据。

------

#### 4. 删除路由

```
cmd


复制代码
route delete 172.168.40.8
```

解释：

- 删除到目标 `172.168.40.8` 的路由规则。

------

### 路由的作用

操作系统通过路由表决定如何将数据包发送到目标地址。如果目标地址不在本地网络中，就需要通过网关转发。通过 `route` 命令，可以手动指定数据包应该走的路径，以解决以下问题：

- 多网卡环境中路由选择不正确。
- 无法直接到达的目标需要通过特定的中间设备转发。
- 特定目标需要通过特定的网络路径访问。

------

### 流程简化理解

1. **目标地址**：我要访问的目的地是谁？（如 `172.168.40.8`）
2. **子网掩码**：是一个地址还是一群地址？（如 `255.255.255.255` 表示单个地址）
3. **网关地址**：从哪里走才能到达目标？（如 `172.16.31.1` 是通往目标的桥梁）

### 示例场景

假设你的电脑（`172.16.31.176`）在一个子网中，而目标地址（`172.168.40.8`）在另一个子网中，且没有直连。通过设置路由，你的电脑会将数据包发往指定网关（如 `172.16.31.1`），由网关帮你转发到目标网段。